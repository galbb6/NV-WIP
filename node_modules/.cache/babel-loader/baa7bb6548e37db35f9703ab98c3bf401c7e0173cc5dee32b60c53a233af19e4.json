{"ast":null,"code":"var _jsxFileName = \"/Users/galbinyamin/Desktop/NVIDIA/excel-analysis/src/components/FileUpload.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport XLSX from 'xlsx/dist/xlsx.full.min';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FileUpload = ({\n  onFileUpload,\n  searchString\n}) => {\n  _s();\n  const [analyzedData, setAnalyzedData] = useState(null);\n  const handleFileChange = async e => {\n    const uploadedFile = e.target.files[0];\n    const reader = new FileReader();\n    reader.onload = async e => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, {\n        type: 'array'\n      });\n      const analyzedResults = analyzeExcelData(workbook);\n      setAnalyzedData(analyzedResults);\n    };\n    reader.readAsArrayBuffer(uploadedFile);\n  };\n  const analyzeExcelData = workbook => {\n    const analyzedResults = {\n      Kanban: 0,\n      'In Process': 0,\n      Failed: 0\n    };\n    const sheetName = workbook.SheetNames[0];\n    const sheet = workbook.Sheets[sheetName];\n    const rows = XLSX.utils.sheet_to_json(sheet, {\n      header: 1\n    });\n\n    // Assuming the header row is the first row in the sheet\n    const headerRow = rows[0];\n    for (let i = 1; i < rows.length; i++) {\n      const row = rows[i];\n      const pn = row[headerRow.indexOf('PN')];\n      const lastStation = row[headerRow.indexOf('Last Station')];\n      const returned = parseInt(row[headerRow.indexOf('Returned')]);\n      const woType = row[headerRow.indexOf('Wo Type')];\n      const condition = row[headerRow.indexOf('Condition')];\n      if (pn && lastStation && returned !== 0 && woType === 'ARRIBA') {\n        if (lastStation === 1261 || lastStation === 1181) {\n          analyzedResults.Kanban += 1;\n        } else if (condition === 'Fail') {\n          analyzedResults.Failed += 1;\n        } else if (condition === 'Pass') {\n          analyzedResults['In Process'] += 1;\n        }\n      }\n    }\n    return analyzedResults;\n  };\n  useEffect(() => {\n    if (analyzedData !== null) {\n      const workbook = XLSX.utils.json_to_sheet([analyzedData]);\n      const updatedResults = analyzeExcelData(workbook);\n      setAnalyzedData(updatedResults);\n    }\n  }, [searchString]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"file-upload\",\n    children: /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: handleFileChange,\n      accept: \".xlsx\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n_s(FileUpload, \"EXWJ1WrMnkjIe6q/dNjzr42aBBc=\");\n_c = FileUpload;\nexport default FileUpload;\nvar _c;\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"names":["React","useState","useEffect","XLSX","jsxDEV","_jsxDEV","FileUpload","onFileUpload","searchString","_s","analyzedData","setAnalyzedData","handleFileChange","e","uploadedFile","target","files","reader","FileReader","onload","data","Uint8Array","result","workbook","read","type","analyzedResults","analyzeExcelData","readAsArrayBuffer","Kanban","Failed","sheetName","SheetNames","sheet","Sheets","rows","utils","sheet_to_json","header","headerRow","i","length","row","pn","indexOf","lastStation","returned","parseInt","woType","condition","json_to_sheet","updatedResults","className","children","onChange","accept","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/galbinyamin/Desktop/NVIDIA/excel-analysis/src/components/FileUpload.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport XLSX from 'xlsx/dist/xlsx.full.min';\n\nconst FileUpload = ({ onFileUpload, searchString }) => {\n  const [analyzedData, setAnalyzedData] = useState(null);\n\n  const handleFileChange = async (e) => {\n    const uploadedFile = e.target.files[0];\n\n    const reader = new FileReader();\n    reader.onload = async (e) => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, { type: 'array' });\n\n      const analyzedResults = analyzeExcelData(workbook);\n      setAnalyzedData(analyzedResults);\n    };\n    reader.readAsArrayBuffer(uploadedFile);\n  };\n\n  const analyzeExcelData = (workbook) => {\n    const analyzedResults = {\n      Kanban: 0,\n      'In Process': 0,\n      Failed: 0,\n    };\n\n    const sheetName = workbook.SheetNames[0];\n    const sheet = workbook.Sheets[sheetName];\n    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });\n\n    // Assuming the header row is the first row in the sheet\n    const headerRow = rows[0];\n\n    for (let i = 1; i < rows.length; i++) {\n      const row = rows[i];\n      const pn = row[headerRow.indexOf('PN')];\n      const lastStation = row[headerRow.indexOf('Last Station')];\n      const returned = parseInt(row[headerRow.indexOf('Returned')]);\n      const woType = row[headerRow.indexOf('Wo Type')];\n      const condition = row[headerRow.indexOf('Condition')];\n\n      if (pn && lastStation && returned !== 0 && woType === 'ARRIBA') {\n        if (lastStation === 1261 || lastStation === 1181) {\n          analyzedResults.Kanban += 1;\n        } else if (condition === 'Fail') {\n          analyzedResults.Failed += 1;\n        } else if (condition === 'Pass') {\n          analyzedResults['In Process'] += 1;\n        }\n      }\n    }\n\n    return analyzedResults;\n  };\n\n  useEffect(() => {\n    if (analyzedData !== null) {\n      const workbook = XLSX.utils.json_to_sheet([analyzedData]);\n      const updatedResults = analyzeExcelData(workbook);\n      setAnalyzedData(updatedResults);\n    }\n  }, [searchString]);\n\n  return (\n    <div className=\"file-upload\">\n      <input type=\"file\" onChange={handleFileChange} accept=\".xlsx\" />\n    </div>\n  );\n};\n\nexport default FileUpload;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}